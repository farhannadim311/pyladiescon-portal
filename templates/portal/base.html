{% load i18n %}
{% load static %}

<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>
            {% block head_title %}
            {% endblock head_title %}
        </title>
        
        <!-- OpenGraph Meta Tags -->
        <meta property="og:title" content="PyLadiesCon Web Portal" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="{{ request.build_absolute_uri }}" />
        <meta property="og:image" content="https://conference.pyladies.com/img/icon.png" />
        <meta property="og:description" content="Welcome to PyLadiesCon Conference Management Portal. Sign up to volunteer with us!" />
        <meta property="og:site_name" content="PyLadiesCon" />
        
        <!-- Twitter Card Meta Tags -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:title" content="PyLadiesCon Web Portal" />
        <meta name="twitter:description" content="Welcome to PyLadiesCon Conference Management Portal. Sign up to volunteer with us!" />
        <meta name="twitter:image" content="https://conference.pyladies.com/img/icon.png" />
        
        <!-- Custom Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
        
        <!-- Tailwind -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            pyladies: {
                                purple: '#2D1B2D',
                                pink: '#FF3366',
                                'pink-light': '#FF6B93'
                            }
                        },
                        fontFamily: {
                            'retro': ['"Press Start 2P"', 'cursive'],
                            'tech': ['"Share Tech Mono"', 'monospace']
                        }
                    }
                }
            }
        </script>
        
        <!-- Font Awesome -->
        <script src="https://kit.fontawesome.com/8774ceef9d.js" crossorigin="anonymous"></script>
        
        <!-- Custom CSS (loaded last to override other styles) -->
        <link rel="stylesheet" href="{% static 'css/auth.css' %}">
        
        {% block extra_head %}
        {% endblock extra_head %}

        <style>
            .bg-pyladies-purple {
                background: linear-gradient(135deg, #2D1B2D 0%, #1a0f1a 100%);
            }
            
            .text-pyladies-pink {
                color: #FF3366;
                text-shadow: 0 0 10px rgba(255, 51, 102, 0.3);
            }
            
            .hover\:text-pyladies-pink:hover {
                color: #FF3366;
                text-shadow: 0 0 15px rgba(255, 51, 102, 0.5);
            }
            
            .bg-pyladies-pink {
                background-color: #FF3366;
                box-shadow: 0 0 15px rgba(255, 51, 102, 0.3);
            }
            
            .hover\:bg-pyladies-pink:hover {
                background-color: #FF3366;
                box-shadow: 0 0 20px rgba(255, 51, 102, 0.5);
            }
            
            .border-pyladies-pink {
                border-color: #FF3366;
            }
            
            .hover\:bg-pyladies-pink-light:hover {
                background-color: #FF6B93;
            }
            
            .retro-shadow {
                text-shadow: 2px 2px 0px rgba(255, 51, 102, 0.5);
            }
            
            .menu-logo {
                filter: drop-shadow(0 0 10px rgba(255, 51, 102, 0.3));
            }

            /* Theme specific styles */
            .light-mode {
                background: linear-gradient(135deg, #fff5f7 0%, #ffe0e9 100%);
                color: #1a0f1a;
            }

            .dark-mode {
                background: linear-gradient(135deg, #2D1B2D 0%, #1a0f1a 100%);
                color: white;
            }

            .light-mode .bg-pyladies-purple {
                background: rgba(255, 255, 255, 0.9);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 51, 102, 0.2);
            }

            .dark-mode .bg-pyladies-purple {
                background: rgba(45, 27, 45, 0.9);
                backdrop-filter: blur(10px);
            }

            /* Light mode text color overrides for better contrast */
            .light-mode .text-pyladies-purple,
            .light-mode .text-white {
                color: #1a0f1a;
            }

            .light-mode .font-tech {
                color: #2D1B2D;
            }

            .light-mode input::placeholder {
                color: #4a2d4a;
            }

            .light-mode .text-gray-600 {
                color: #2D1B2D;
            }

            .light-mode .border-gray-800 {
                border-color: rgba(255, 51, 102, 0.2);
            }

            .light-mode .bg-gray-800 {
                background-color: rgba(255, 51, 102, 0.1);
            }

            .light-mode .text-gray-200 {
                color: #2D1B2D;
            }
        </style>
        <script>
            function toggleTheme() {
                const body = document.body;
                const themeToggle = document.querySelector('.theme-toggle');
                const themeText = themeToggle.querySelector('.theme-text');
                const themeIcon = themeToggle.querySelector('i');
                
                if (body.classList.contains('dark-mode')) {
                    body.classList.remove('dark-mode');
                    body.classList.add('light-mode');
                    themeText.textContent = 'Dark Mode';
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    localStorage.setItem('theme', 'light');
                } else {
                    body.classList.remove('light-mode');
                    body.classList.add('dark-mode');
                    themeText.textContent = 'Light Mode';
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    localStorage.setItem('theme', 'dark');
                }
            }

            // Set initial theme based on user preference
            document.addEventListener('DOMContentLoaded', () => {
                const savedTheme = localStorage.getItem('theme') || 'dark';
                const body = document.body;
                const themeToggle = document.querySelector('.theme-toggle');
                const themeText = themeToggle.querySelector('.theme-text');
                const themeIcon = themeToggle.querySelector('i');

                if (savedTheme === 'light') {
                    body.classList.remove('dark-mode');
                    body.classList.add('light-mode');
                    themeText.textContent = 'Dark Mode';
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                }
            });
        </script>
    </head>
    <body class="dark-mode min-h-screen">
        <button onclick="toggleTheme()" class="theme-toggle">
            <i class="fa-solid fa-moon"></i>
            <span class="theme-text">Light Mode</span>
        </button>
        {% block body %}
        {% endblock %}
        <nav class="bg-pyladies-purple text-white border-b border-gray-800">
            <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                <a class="flex items-center" href="/" aria-label="PyLadiesCon">
                    <img class="menu-logo" src="https://conference.pyladies.com/img/icon.png" height="48" width="48">
                </a>
                
                <div class="flex items-center">
                    <a class="hidden md:block py-2 px-4 text-white hover:text-pyladies-pink font-tech" href="/">Home</a>
                    
                    <button class="md:hidden px-2 py-1 border rounded text-white" type="button" id="menuButton" aria-expanded="false" onclick="toggleMenu()">
                        <span class="sr-only">Toggle navigation</span>
                        <i class="fa-solid fa-bars"></i>
                    </button>
                </div>

                <div class="hidden md:flex flex-col md:flex-row w-full md:w-auto" id="navbarMenu">
                    <ul class="flex flex-col md:flex-row md:space-x-4 mb-2 md:mb-0">
                        {% if user.is_authenticated %}
                            <li>
                                <a class="block py-2 text-white hover:text-pyladies-pink font-tech" href="{% url 'volunteer:index' %}">Volunteer</a>
                            </li>
                        {% endif %}
                    </ul>
                    {% if user.is_authenticated %}
                        <div class="relative ml-auto">
                            <button class="flex items-center text-white hover:text-pyladies-pink font-tech" type="button" id="userDropdown" onclick="toggleDropdown()">
                                Welcome, {{ user.username }}
                                <i class="fa-solid fa-angle-down ml-1"></i>
                            </button>
                            <ul class="hidden absolute right-0 mt-2 py-2 w-48 bg-gray-900 rounded-md shadow-lg z-10 font-tech" id="dropdownMenu">
                                {% if user.is_superuser %}
                                    <li>
                                        <a class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800" href="{% url 'admin:index' %}">{% trans "Admin Area" %}</a>
                                    </li>
                                    <li class="border-t border-gray-700"></li>
                                {% endif %}
                                <li>
                                    <a class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800" href="{% url 'portal_account:index' %}">{% trans "Manage Profile" %}</a>
                                </li>
                                {% url 'account_email' as email_url_ %}
                                {% if email_url_ %}
                                    <li>
                                        <a class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800" href="{{ email_url_ }}">{% trans "Manage Emails" %}</a>
                                    </li>
                                {% endif %}
                                {% url 'account_change_password' as change_password_url_ %}
                                {% if change_password_url_ %}
                                    <li>
                                        <a class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800" href="{{ change_password_url_ }}">{% trans "Change Password" %}</a>
                                    </li>
                                {% endif %}
                                <li class="border-t border-gray-700"></li>
                                {% url 'account_logout' as logout_url_ %}
                                {% if logout_url_ %}
                                    <li>
                                        <a class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800" href="{{ logout_url_ }}">{% trans "Sign Out" %}</a>
                                    </li>
                                {% endif %}
                            </ul>
                        </div>
                    {% endif %}
                </div>
            </div>
        </nav>
        <div class="bg-gray-800 bg-opacity-50 text-gray-200 px-4 py-3 font-tech" role="alert">
            <strong class="font-bold">Development Notice:</strong> The codebase is real, but the database is not. Any signups, accounts, or data entered on this site may be deleted without notice. For now, feel free to play around.
        </div>
        <div class="container mx-auto px-4 my-5">
            {% block content %}
            {% endblock %}
        </div>

        <script>
            function toggleMenu() {
                const menu = document.getElementById('navbarMenu');
                menu.classList.toggle('hidden');
            }

            function toggleDropdown() {
                const dropdown = document.getElementById('dropdownMenu');
                dropdown.classList.toggle('hidden');
            }

            // Close the dropdown when clicking outside
            window.addEventListener('click', function(e) {
                if (!document.getElementById('userDropdown')?.contains(e.target)) {
                    document.getElementById('dropdownMenu')?.classList.add('hidden');
                }
            });
        </script>
    </body>
</html>